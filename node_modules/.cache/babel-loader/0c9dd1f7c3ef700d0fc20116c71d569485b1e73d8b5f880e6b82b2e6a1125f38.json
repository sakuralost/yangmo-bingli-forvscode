{"ast":null,"code":"var _jsxFileName = \"F:\\\\Users\\\\\\u8FF7\\u5931\\u5C0F\\u7237\\\\\\u6587\\u6863\\\\Aicoder\\\\vscode\\\\bingli\\\\medical-record-assistant\\\\src\\\\pages\\\\HomePage.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport RecordList from '../components/RecordList';\nimport { fetchRecords } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ADMIN_PASSWORD = '19890523'; // 管理员密码\n\nconst HomePage = () => {\n  _s();\n  const navigate = useNavigate();\n  const [records, setRecords] = useState([]);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [loadError, setLoadError] = useState(null);\n\n  // 验证管理员密码\n  const handleLogin = () => {\n    if (password === ADMIN_PASSWORD) {\n      setIsAuthenticated(true);\n      setError('');\n      // 将认证状态保存在 sessionStorage 中，这样刷新页面时不需要重新输入密码\n      sessionStorage.setItem('isAuthenticated', 'true');\n    } else {\n      setError('密码错误');\n    }\n    setPassword('');\n  };\n\n  // 检查是否已经认证\n  useEffect(() => {\n    const auth = sessionStorage.getItem('isAuthenticated');\n    if (auth === 'true') {\n      setIsAuthenticated(true);\n    }\n  }, []);\n\n  // 加载病例数据\n  useEffect(() => {\n    if (isAuthenticated) {\n      const loadRecords = async () => {\n        setIsLoading(true);\n        setLoadError(null);\n        try {\n          const fetchedRecords = await fetchRecords();\n          setRecords(fetchedRecords);\n        } catch (error) {\n          setLoadError(error instanceof Error ? error.message : '加载病例数据失败');\n          console.error('加载病例数据失败:', error);\n        } finally {\n          setIsLoading(false);\n        }\n      };\n      loadRecords();\n    }\n  }, [isAuthenticated]);\n\n  // 跳转到新增病例页面\n  const handleAddNewRecord = () => {\n    navigate('/patient');\n  };\n\n  // 如果未认证，显示登录界面\n  if (!isAuthenticated) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"login-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\u75C5\\u4F8B\\u8BB0\\u5F55\\u8F85\\u52A9\\u8F6F\\u4EF6\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"login-form\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          value: password,\n          onChange: e => setPassword(e.target.value),\n          placeholder: \"\\u8BF7\\u8F93\\u5165\\u7BA1\\u7406\\u5458\\u5BC6\\u7801\",\n          onKeyPress: e => e.key === 'Enter' && handleLogin()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogin,\n          children: \"\\u767B\\u5F55\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 21\n        }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error-message\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 31\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }, this);\n  }\n\n  // 已认证，显示主界面\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"home-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"app-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u75C5\\u4F8B\\u8BB0\\u5F55\\u8F85\\u52A9\\u8F6F\\u4EF6\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"add-record-button\",\n        onClick: handleAddNewRecord,\n        children: \"\\u65B0\\u589E\\u75C5\\u4F8B\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"main-content\",\n      children: [isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading\",\n        children: \"\\u6B63\\u5728\\u52A0\\u8F7D\\u6570\\u636E...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 31\n      }, this), loadError && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-message\",\n        children: [loadError, /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => window.location.reload(),\n          children: \"\\u91CD\\u8BD5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 21\n      }, this), !isLoading && !loadError && /*#__PURE__*/_jsxDEV(RecordList, {\n        records: records\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 46\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 9\n  }, this);\n};\n_s(HomePage, \"58GMXXJJUFqcBCv6T8TWzQPngUQ=\", false, function () {\n  return [useNavigate];\n});\n_c = HomePage;\nexport default HomePage;\nvar _c;\n$RefreshReg$(_c, \"HomePage\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","RecordList","fetchRecords","jsxDEV","_jsxDEV","ADMIN_PASSWORD","HomePage","_s","navigate","records","setRecords","isAuthenticated","setIsAuthenticated","password","setPassword","error","setError","isLoading","setIsLoading","loadError","setLoadError","handleLogin","sessionStorage","setItem","auth","getItem","loadRecords","fetchedRecords","Error","message","console","handleAddNewRecord","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","value","onChange","e","target","placeholder","onKeyPress","key","onClick","window","location","reload","_c","$RefreshReg$"],"sources":["F:/Users/迷失小爷/文档/Aicoder/vscode/bingli/medical-record-assistant/src/pages/HomePage.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport RecordList from '../components/RecordList';\nimport { fetchRecords } from '../services/api';\nimport { Record } from '../types';\n\nconst ADMIN_PASSWORD = '19890523'; // 管理员密码\n\nconst HomePage: React.FC = () => {\n    const navigate = useNavigate();\n    const [records, setRecords] = useState<Record[]>([]);\n    const [isAuthenticated, setIsAuthenticated] = useState(false);\n    const [password, setPassword] = useState('');\n    const [error, setError] = useState('');\n    const [isLoading, setIsLoading] = useState(false);\n    const [loadError, setLoadError] = useState<string | null>(null);\n\n    // 验证管理员密码\n    const handleLogin = () => {\n        if (password === ADMIN_PASSWORD) {\n            setIsAuthenticated(true);\n            setError('');\n            // 将认证状态保存在 sessionStorage 中，这样刷新页面时不需要重新输入密码\n            sessionStorage.setItem('isAuthenticated', 'true');\n        } else {\n            setError('密码错误');\n        }\n        setPassword('');\n    };\n\n    // 检查是否已经认证\n    useEffect(() => {\n        const auth = sessionStorage.getItem('isAuthenticated');\n        if (auth === 'true') {\n            setIsAuthenticated(true);\n        }\n    }, []);\n\n    // 加载病例数据\n    useEffect(() => {\n        if (isAuthenticated) {\n            const loadRecords = async () => {\n                setIsLoading(true);\n                setLoadError(null);\n                try {\n                    const fetchedRecords = await fetchRecords();\n                    setRecords(fetchedRecords);\n                } catch (error) {\n                    setLoadError(error instanceof Error ? error.message : '加载病例数据失败');\n                    console.error('加载病例数据失败:', error);\n                } finally {\n                    setIsLoading(false);\n                }\n            };\n            loadRecords();\n        }\n    }, [isAuthenticated]);\n\n    // 跳转到新增病例页面\n    const handleAddNewRecord = () => {\n        navigate('/patient');\n    };\n\n    // 如果未认证，显示登录界面\n    if (!isAuthenticated) {\n        return (\n            <div className=\"login-container\">\n                <h2>病例记录辅助软件</h2>\n                <div className=\"login-form\">\n                    <input\n                        type=\"password\"\n                        value={password}\n                        onChange={(e) => setPassword(e.target.value)}\n                        placeholder=\"请输入管理员密码\"\n                        onKeyPress={(e) => e.key === 'Enter' && handleLogin()}\n                    />\n                    <button onClick={handleLogin}>登录</button>\n                    {error && <p className=\"error-message\">{error}</p>}\n                </div>\n            </div>\n        );\n    }\n\n    // 已认证，显示主界面\n    return (\n        <div className=\"home-page\">\n            <header className=\"app-header\">\n                <h1>病例记录辅助软件</h1>\n                <button\n                    className=\"add-record-button\"\n                    onClick={handleAddNewRecord}\n                >\n                    新增病例\n                </button>\n            </header>\n\n            <main className=\"main-content\">\n                {isLoading && <div className=\"loading\">正在加载数据...</div>}\n                {loadError && (\n                    <div className=\"error-message\">\n                        {loadError}\n                        <button onClick={() => window.location.reload()}>重试</button>\n                    </div>\n                )}\n                {!isLoading && !loadError && <RecordList records={records} />}\n            </main>\n        </div>\n    );\n};\n\nexport default HomePage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}